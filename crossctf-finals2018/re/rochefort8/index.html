



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Our CTF writeups">
      
      
        <link rel="canonical" href="https://osilayer8.cf/crossctf-finals2018/re/rochefort8/">
      
      
        <meta name="author" content="OSI Layer 8">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.9.0">
    
    
      
        <title>CrossCTF Finals 2018 : Rochefort 8 (re) - OSI Layer 8</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.4f4f49e8.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="light-blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#crossctf-finals-2018-rochefort-8-re" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://osilayer8.cf/" title="OSI Layer 8" class="md-header-nav__button md-logo">
          
            <img src="../../../img/logo_white.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                OSI Layer 8
              </span>
              <span class="md-header-nav__topic">
                CrossCTF Finals 2018 : Rochefort 8 (re)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/nushosilayer8/writeups/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      nushosilayer8
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../../img/logo_white.svg" width="48" height="48">
      
    </span>
    OSI Layer 8
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/nushosilayer8/writeups/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      nushosilayer8
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Index" class="md-nav__link">
      Index
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Crossctf finals2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Crossctf finals2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-1" type="checkbox" id="nav-2-1-1">
    
    <label class="md-nav__link" for="nav-2-1-1">
      Babyrsa3
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-1">
        Babyrsa3
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/babyrsa3/" title="CrossCTF Finals 2018 : BabyRSA3 (crypto)" class="md-nav__link">
      CrossCTF Finals 2018 : BabyRSA3 (crypto)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-2" type="checkbox" id="nav-2-1-2">
    
    <label class="md-nav__link" for="nav-2-1-2">
      Fitblips
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-2">
        Fitblips
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/fitblips/" title="CrossCTF Finals 2018 : fitblips (crypto)" class="md-nav__link">
      CrossCTF Finals 2018 : fitblips (crypto)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2-1" type="checkbox" id="nav-2-2-1">
    
    <label class="md-nav__link" for="nav-2-2-1">
      Evil
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-1">
        Evil
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/evil/" title="CrossCTF Finals 2018 : The Evilness (Misc)" class="md-nav__link">
      CrossCTF Finals 2018 : The Evilness (Misc)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Mobile
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Mobile
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3-1" type="checkbox" id="nav-2-3-1">
    
    <label class="md-nav__link" for="nav-2-3-1">
      Human
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-1">
        Human
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mobile/human/" title="CrossCTF Finals 2018 : Human Powered Flag Generator" class="md-nav__link">
      CrossCTF Finals 2018 : Human Powered Flag Generator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-1" type="checkbox" id="nav-2-4-1">
    
    <label class="md-nav__link" for="nav-2-4-1">
      Cocacola
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-1">
        Cocacola
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/cocacola/" title="CrossCTF Finals 2018 : Coca Cola (Pwn)" class="md-nav__link">
      CrossCTF Finals 2018 : Coca Cola (Pwn)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-2" type="checkbox" id="nav-2-4-2">
    
    <label class="md-nav__link" for="nav-2-4-2">
      Ftlog
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-2">
        Ftlog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/ftlog/" title="CrossCTF Finals 2018 : FTLOG (Pwn)" class="md-nav__link">
      CrossCTF Finals 2018 : FTLOG (Pwn)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-3" type="checkbox" id="nav-2-4-3">
    
    <label class="md-nav__link" for="nav-2-4-3">
      Gruffybear
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-3">
        Gruffybear
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/gruffybear/" title="CrossCTF Finals 2018 : GruffyBear (Pwn)" class="md-nav__link">
      CrossCTF Finals 2018 : GruffyBear (Pwn)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-4" type="checkbox" id="nav-2-4-4">
    
    <label class="md-nav__link" for="nav-2-4-4">
      Slowmo
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-4">
        Slowmo
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/slowmo/" title="CrossCTF Finals 2018 : Slowmo (Pwn)" class="md-nav__link">
      CrossCTF Finals 2018 : Slowmo (Pwn)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-5" type="checkbox" id="nav-2-4-5">
    
    <label class="md-nav__link" for="nav-2-4-5">
      Souvlaki
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-5">
        Souvlaki
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pwn/souvlaki/" title="CrossCTF Finals 2018 : Souvlaki Space Station (Pwn)" class="md-nav__link">
      CrossCTF Finals 2018 : Souvlaki Space Station (Pwn)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" checked>
    
    <label class="md-nav__link" for="nav-2-5">
      Re
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        Re
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-1" type="checkbox" id="nav-2-5-1">
    
    <label class="md-nav__link" for="nav-2-5-1">
      Perfect
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-1">
        Perfect
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../perfect/" title="CrossCTF Finals 2018 : Perfect (re)" class="md-nav__link">
      CrossCTF Finals 2018 : Perfect (re)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-2" type="checkbox" id="nav-2-5-2">
    
    <label class="md-nav__link" for="nav-2-5-2">
      Rochefort6
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-2">
        Rochefort6
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rochefort6/" title="CrossCTF Finals 2018 : Rochefort 6 (re)" class="md-nav__link">
      CrossCTF Finals 2018 : Rochefort 6 (re)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-3" type="checkbox" id="nav-2-5-3" checked>
    
    <label class="md-nav__link" for="nav-2-5-3">
      Rochefort8
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-5-3">
        Rochefort8
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        CrossCTF Finals 2018 : Rochefort 8 (re)
      </label>
    
    <a href="./" title="CrossCTF Finals 2018 : Rochefort 8 (re)" class="md-nav__link md-nav__link--active">
      CrossCTF Finals 2018 : Rochefort 8 (re)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#analysis" title="Analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reversing-them" title="Reversing them" class="md-nav__link">
    Reversing them
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" title="Solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#some-re-addressing" title="Some re-addressing" class="md-nav__link">
    Some re-addressing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crossctf quals2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Crossctf quals2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      CYOA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        CYOA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/CYOA/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-1" type="checkbox" id="nav-3-3-1">
    
    <label class="md-nav__link" for="nav-3-3-1">
      BabyRSA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-1">
        BabyRSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/crypto/BabyRSA/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-2" type="checkbox" id="nav-3-3-2">
    
    <label class="md-nav__link" for="nav-3-3-2">
      BabyRSA2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-2">
        BabyRSA2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/crypto/BabyRSA2/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-3" type="checkbox" id="nav-3-3-3">
    
    <label class="md-nav__link" for="nav-3-3-3">
      Lossyoracle
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-3">
        Lossyoracle
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/crypto/lossyoracle/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-1" type="checkbox" id="nav-3-4-1">
    
    <label class="md-nav__link" for="nav-3-4-1">
      Evenflow
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-1">
        Evenflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/pwn/evenflow/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      Impossible shellcoding
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        Impossible shellcoding
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../crossctf-quals2018/pwn/impossible_shellcoding/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#analysis" title="Analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reversing-them" title="Reversing them" class="md-nav__link">
    Reversing them
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" title="Solution" class="md-nav__link">
    Solution
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#some-re-addressing" title="Some re-addressing" class="md-nav__link">
    Some re-addressing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/nushosilayer8/writeups/edit/master/writeups/crossctf-finals2018/re/rochefort8/README.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="crossctf-finals-2018-rochefort-8-re">CrossCTF Finals 2018 : Rochefort 8 (re)</h1>
<blockquote>
<p>Why have a Rochefort 6 when you can have a Rochefort 8?</p>
<p>nc ctf.pwn.sg 16667</p>
<p>Creator - waituck (@wongwaituck)</p>
<p><a href="../towerofbeer">towerofbeer</a></p>
</blockquote>
<h2 id="analysis">Analysis</h2>
<p>Like <a href="../../rochefort6">rochefort6</a>, it asks for a number, we choose 8, then it presents us with the challenge.</p>
<p>Being noob and using IDA gives us</p>
<pre><code class="c">unsigned __int64 sub_401209()
{
  __int64 v1; // [rsp+8h] [rbp-158h]
  char v2; // [rsp+10h] [rbp-150h]
  __int64 v3; // [rsp+30h] [rbp-130h]
  __int64 v4; // [rsp+38h] [rbp-128h]
  __int64 v5; // [rsp+58h] [rbp-108h]
  int v6; // [rsp+60h] [rbp-100h]
  int *v7; // [rsp+68h] [rbp-F8h]
  int *v8; // [rsp+70h] [rbp-F0h]
  __int64 v9; // [rsp+78h] [rbp-E8h]
  int *v10; // [rsp+80h] [rbp-E0h]
  int v11; // [rsp+88h] [rbp-D8h]
  __int64 v12; // [rsp+90h] [rbp-D0h]
  int *v13; // [rsp+98h] [rbp-C8h]
  int *v14; // [rsp+A0h] [rbp-C0h]
  __int64 *v15; // [rsp+A8h] [rbp-B8h]
  int v16; // [rsp+B0h] [rbp-B0h]
  __int64 v17; // [rsp+B8h] [rbp-A8h]
  int *v18; // [rsp+C0h] [rbp-A0h]
  int *v19; // [rsp+C8h] [rbp-98h]
  __int64 v20; // [rsp+D0h] [rbp-90h]
  int v21; // [rsp+D8h] [rbp-88h]
  __int64 *v22; // [rsp+E0h] [rbp-80h]
  __int64 v23; // [rsp+E8h] [rbp-78h]
  __int64 v24; // [rsp+F0h] [rbp-70h]
  __int64 v25; // [rsp+F8h] [rbp-68h]
  int v26; // [rsp+100h] [rbp-60h]
  __int64 *v27; // [rsp+108h] [rbp-58h]
  __int64 v28; // [rsp+110h] [rbp-50h]
  __int64 v29; // [rsp+118h] [rbp-48h]
  __int64 v30; // [rsp+120h] [rbp-40h]
  int v31; // [rsp+128h] [rbp-38h]
  __int64 v32; // [rsp+130h] [rbp-30h]
  __int64 v33; // [rsp+138h] [rbp-28h]
  int *v34; // [rsp+140h] [rbp-20h]
  __int64 v35; // [rsp+148h] [rbp-18h]
  unsigned __int64 v36; // [rsp+158h] [rbp-8h]

  v36 = __readfsqword(0x28u);
  if ( ptrace(0, 0LL, 1LL, 0LL) == -1 )
  {
    puts(&quot;Something bad happened!&quot;);
    exit(1);
  }
  printf(&quot;This address may be interesting...\n0x%lx\n&quot;, &amp;v6);
  v6 = 3;
  v11 = 5;
  v16 = 1;
  v21 = 6;
  v26 = 2;
  v31 = 4;
  v7 = &amp;v11;
  v8 = &amp;v16;
  v9 = 0LL;
  v10 = &amp;v11;
  v12 = -3LL;
  v13 = &amp;v21;
  v14 = &amp;v26;
  v15 = &amp;v4;
  v17 = 0x7FFFFFFFFFFFFFFFLL;
  v18 = &amp;v26;
  v19 = &amp;v31;
  v20 = 0LL;
  v22 = &amp;v3;
  v23 = 0LL;
  v24 = 0LL;
  v25 = -3405691582LL;
  v27 = &amp;v5;
  v28 = 0LL;
  v29 = 0LL;
  v30 = -1LL;
  v32 = 0LL;
  v33 = 1LL;
  v34 = &amp;v21;
  v35 = 0LL;
  puts(&quot;Now let's see if you can read my mind. Give me 10 numbers!&quot;);
  sub_4009D6((__int64)&amp;v2);
  v1 = 0LL;
  some_func((__int64)&amp;v6, (__int64)&amp;v2, &amp;v1);
  if ( v1 != 5 )
  {
    puts(&quot;FAIL&quot;);
    exit(1);
  }
  sub_400CAC();
  return __readfsqword(0x28u) ^ v36;
}

__int64 __fastcall sub_4009D6(__int64 a1)
{
  __int64 result; // rax

  result = (signed int)__isoc99_scanf(
                         &quot;%ld %ld %ld %ld %ld %ld %ld %ld %ld %ld&quot;,
                         a1,
                         a1 + 8,
                         a1 + 16,
                         a1 + 24,
                         a1 + 32,
                         a1 + 40,
                         a1 + 48,
                         a1 + 56,
                         a1 + 64,
                         a1 + 72);
  if ( (unsigned __int64)(signed int)result &lt;= 9 )
  {
    puts(&quot;FAIL&quot;);
    exit(1);
  }
  return result;
}

__int64 __fastcall some_func(__int64 a1, __int64 a2, _QWORD *a3)
{
  __int64 result; // rax
  _QWORD *v4; // [rsp+8h] [rbp-38h]
  __int64 v5; // [rsp+30h] [rbp-10h]
  __int64 v6; // [rsp+38h] [rbp-8h]

  v4 = a3;
  v5 = sub_400D4E(a1);
  result = sub_400DC3(a1);
  v6 = result;
  if ( v5 )
  {
    if ( (unsigned __int8)sub_400F22(a1, v5, *(_QWORD *)(8LL * *v4 + a2), *(_QWORD *)(8 * (*v4 + 5LL) + a2), 1) )
      ++*v4;
    result = some_func(v5, a2, v4);
  }
  if ( v6 )
  {
    if ( (unsigned __int8)sub_400F22(a1, v6, *(_QWORD *)(8LL * *v4 + a2), *(_QWORD *)(8 * (*v4 + 5LL) + a2), 0) )
      ++*v4;
    result = some_func(v6, a2, v4);
  }
  return result;
}

_BOOL8 __fastcall sub_400F22(__int64 a1, __int64 a2, __int64 a3, __int64 a4, char a5)
{
  char v6; // [rsp+4h] [rbp-74h]
  __int64 v7; // [rsp+8h] [rbp-70h]
  __int64 v8; // [rsp+10h] [rbp-68h]
  __int64 v9; // [rsp+28h] [rbp-50h]
  __int64 v10; // [rsp+30h] [rbp-48h]
  __int64 v11; // [rsp+38h] [rbp-40h]
  __int64 v12; // [rsp+40h] [rbp-38h]
  __int64 v13; // [rsp+58h] [rbp-20h]
  __int64 v14; // [rsp+60h] [rbp-18h]

  v8 = a3;
  v7 = a4;
  v6 = a5;
  v9 = sub_400E38(a1);
  v10 = sub_400E38(a2);
  if ( v6 )
  {
    if ( v9 &lt;= v8 )
      return 0LL;
  }
  else if ( v9 &gt;= v8 )
  {
    return 0LL;
  }
  if ( v8 == v10 )
    return 0LL;
  v11 = sub_400D4E(a2);
  v12 = sub_400DC3(a2);
  if ( v11 &amp;&amp; sub_400E38(v11) &gt;= v8 )
    return 0LL;
  if ( v12 &amp;&amp; sub_400E38(v12) &lt;= v8 )
    return 0LL;
  v13 = sub_400EAD(a1);
  v14 = sub_400EAD(a2);
  if ( v6 )
  {
    if ( v13 &lt;= v7 )
      return 0LL;
  }
  else if ( v13 &gt;= v7 )
  {
    return 0LL;
  }
  if ( v7 == v14 )
    return 0LL;
  if ( v11 &amp;&amp; sub_400EAD(v11) &gt;= v7 )
    return 0LL;
  return !v12 || sub_400EAD(v12) &gt; v7;
}
</code></pre>

<p>Very long code, to summarize, it</p>
<ol>
<li>Prints out an address on the stack</li>
<li>Does a ton of initialization on the variables</li>
<li>Calls scanf to read in 10 signed integers</li>
<li>Calls <code>some_func</code> (it was a stripped binary, I named it this) with some paremeters, that seemed to be stack addresses casted to integer.</li>
<li>If the result is equal to 5, print flag</li>
</ol>
<p>In <code>some_func</code> and <code>sub_400F22</code>, we see 3 more different functions.</p>
<pre><code class="c">__int64 __fastcall sub_400D4E(__int64 a1)
{
  __int64 result; // rax

  if ( !a1 )
    return 0LL;
  switch ( *(_DWORD *)a1 )
  {
    case 1:
      result = *(_QWORD *)(a1 + 24);
      break;
    case 2:
      result = *(_QWORD *)(a1 + 16);
      break;
    case 3:
      result = *(_QWORD *)(a1 + 8);
      break;
    case 4:
      result = *(_QWORD *)(a1 + 32);
      break;
    case 5:
      result = *(_QWORD *)(a1 + 16);
      break;
    case 6:
      result = *(_QWORD *)(a1 + 24);
      break;
    default:
      result = 0LL;
      break;
  }
  return result;
}
</code></pre>

<p>The other 2 were pretty much the same, just that the offset values were different.</p>
<h3 id="reversing-them">Reversing them</h3>
<p>Lots of functions, lots of adding and subtracting, lots of casting from integer to pointer, and seems like there's even recursion. It's gonna be a pain to reverse them.</p>
<p>So nah man I didn't want to reverse this. I just used angr to do the work. Yes, I really didn't bother reversing it at all.</p>
<h2 id="solution">Solution</h2>
<p>I wrote a <a href="../solve.py">script</a> with angr to make things easier. (The following is more of my thought process, if not interested, looking at the script should be enough)</p>
<p>First things first, create a project in angr, and initialize a state that starts at <code>sub_401209</code>, which is the function called after we enter "8" into the program (because everything before that is useless). </p>
<pre><code class="python">binary_name = sys.argv[1]
project = angr.Project(binary_name)
initial_state = project.factory.blank_state(addr=0x401209)
</code></pre>

<p>Also, I have to "define" <code>scanf</code> myself because angr does not work well with format string related stuff. Inside my own <code>scanf</code>, I created 10 symbolic values to represent our input, and store them in memory.</p>
<p>That being said, I also have to "skip" the instruction at 0x40126f which calls <code>printf</code>. 
(If you reversed the binary, you may feel that something's wrong, because the output of <code>printf</code> is important. Yes, I made a mistake, which I'll mention later.)</p>
<pre><code class="python">initial_state.globals['solutions'] = []

class ReplacementScanf(angr.SimProcedure):
    def run(self, format_string, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10):
        scanf1 = claripy.BVS('scanf1', 64)
        scanf2 = claripy.BVS('scanf2', 64)
        scanf3 = claripy.BVS('scanf3', 64)
        scanf4 = claripy.BVS('scanf4', 64)
        scanf5 = claripy.BVS('scanf5', 64)
        scanf6 = claripy.BVS('scanf6', 64)
        scanf7 = claripy.BVS('scanf7', 64)
        scanf8 = claripy.BVS('scanf8', 64)
        scanf9 = claripy.BVS('scanf9', 64)
        scanf10 = claripy.BVS('scanf10', 64)

        # The scanf function writes user input to the buffers to which the 
        # parameters point.
        self.state.memory.store(s1, scanf1, endness=project.arch.memory_endness)
        self.state.memory.store(s2, scanf2, endness=project.arch.memory_endness)
        self.state.memory.store(s3, scanf3, endness=project.arch.memory_endness)
        self.state.memory.store(s4, scanf4, endness=project.arch.memory_endness)
        self.state.memory.store(s5, scanf5, endness=project.arch.memory_endness)
        self.state.memory.store(s6, scanf6, endness=project.arch.memory_endness)
        self.state.memory.store(s7, scanf7, endness=project.arch.memory_endness)
        self.state.memory.store(s8, scanf8, endness=project.arch.memory_endness)
        self.state.memory.store(s9, scanf9, endness=project.arch.memory_endness)
        self.state.memory.store(s10, scanf10, endness=project.arch.memory_endness)

        self.state.globals['solutions'].append(scanf1)
        self.state.globals['solutions'].append(scanf2)
        self.state.globals['solutions'].append(scanf3)
        self.state.globals['solutions'].append(scanf4)
        self.state.globals['solutions'].append(scanf5)
        self.state.globals['solutions'].append(scanf6)
        self.state.globals['solutions'].append(scanf7)
        self.state.globals['solutions'].append(scanf8)
        self.state.globals['solutions'].append(scanf9)
        self.state.globals['solutions'].append(scanf10)

        self.state.regs.rax = 10

scanf_symbol = '__isoc99_scanf'
project.hook_symbol(scanf_symbol, ReplacementScanf())

instruction_to_skip_length = 5
@project.hook(0x40126f, length=instruction_to_skip_length)
def skip_printf(state):
    pass
</code></pre>

<p>Then, I created a <code>simulation_manager</code> to explore the binary, with the target address at 0x401441, which is the first instruction after we passed the check, and to avoid 0x40145d, which is the first instruction after we failed the check.</p>
<pre><code class="python">simgr = project.factory.simgr(initial_state)

simgr.explore(find=0x401441, avoid=0x40145d)
</code></pre>

<p>If the simulation managed to reach the target address, print out the values in our input.</p>
<pre><code class="python">if simgr.found:
    print 'found'
    solution_state = simgr.found[0]

    # Grab whatever you set aside in the globals dict.
    stored_solutions = solution_state.globals['solutions']

    for i in range(len(stored_solutions)):
        sol = solution_state.se.eval(stored_solutions[i])
        # 2's complement
        sol = -(0x10000000000000000 - sol) if sol &gt;= 0x8000000000000000 else sol
        sys.stdout.write(str(sol))
        sys.stdout.write(' ')

    print ''
else:
    raise Exception('Could not find the solution')
</code></pre>

<p>Notice that since the program called <code>scanf</code> to read in <code>signed</code> integers, and claripy (angr's solver engine) gives us the unsigned value, I needed to find the 2's complement myself.</p>
<p>Anyways, running the script, and waiting for around 4 minutes gave me 10 numbers. But the program tells me <strong>FAIL</strong>...</p>
<p>But I felt confident that using angr should work, I must be missing something then. And, I realized the <code>printf</code> is used to print an address in the stack, and it says "this address may be interesting". So I asked my teammate why is this useful, then big realization oh right there were some parts where pointers were casted into integers.</p>
<h3 id="some-re-addressing">Some re-addressing</h3>
<p>Fixing this was pretty easy, just initialize the stack frame of our state. And choose our state to start at the first instruction after <code>printf</code> was called, since everything before that was just lame stuff like function prologue, saving stack canary, calling <code>ptrace</code> so that we couldn't run gdb, etc.</p>
<pre><code class="python">leak = sys.argv[2]
initial_state = project.factory.blank_state(addr=0x401274)
initial_state.regs.rsp = leak - 0x60
initial_state.regs.rbp = leak + 0x100
</code></pre>

<p>Instead of just running the script, this time we need to get the address from the service first, after that waiting for another painful 4 minutes, we get the flag.</p>
<p>CrossCTF{@n_Un1iK3Ly_Un10n}</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../rochefort6/" title="CrossCTF Finals 2018 : Rochefort 6 (re)" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                CrossCTF Finals 2018 : Rochefort 6 (re)
              </span>
            </div>
          </a>
        
        
          <a href="../../../crossctf-quals2018/" title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Home
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>